<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Snake Game</title>
    <style>
        /* Simple styling for the game canvas */
        body {
            display: flex;
            align-items: center;
            justify-content: center;
            height: 100vh;
            margin: 0;
            background-color: #f0f0f0;
            font-family: Arial, sans-serif;
        }

        #wrapper {
            text-align: center;
        }

        canvas {
            border: 1px solid #333;
            background-color: #fff;
        }

        #score {
            margin-top: 8px;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <div id="wrapper">
        <canvas id="game" width="400" height="400"></canvas>
        <div id="score">Score: 0</div>
    </div>

    <script>
    // Set up the canvas and context
    const canvas = document.getElementById('game');
    const ctx = canvas.getContext('2d');

    // Size of each square on the grid
    const gridSize = 20;

    // Initial snake: an array of segments, starting with one segment in the center
    let snake = [{ x: 10, y: 10 }];

    // Starting direction: not moving until a key is pressed
    let dx = 0;
    let dy = 0;

    // Apple position (will be randomized in startGame)
    let apple = { x: 5, y: 5 };

    // Score
    let score = 0;
    const scoreElement = document.getElementById('score');

    // Helper to generate a random integer within a range
    function randomInt(max) {
        return Math.floor(Math.random() * max);
    }

    // Initialize or restart the game
    function startGame() {
        snake = [{ x: 10, y: 10 }];
        dx = dy = 0;
        score = 0;
        updateScore();
        placeApple();
    }

    // Place the apple at a random location that doesnâ€™t overlap the snake
    function placeApple() {
        let newPos;
        do {
            newPos = { x: randomInt(canvas.width / gridSize), y: randomInt(canvas.height / gridSize) };
        } while (snake.some(seg => seg.x === newPos.x && seg.y === newPos.y));
        apple = newPos;
    }

    // Update the displayed score
    function updateScore() {
        scoreElement.textContent = `Score: ${score}`;
    }

    // Main draw loop: moves the snake, checks collisions, and draws everything
    function draw() {
        // Move the snake by adding a new head based on direction
        const head = { x: snake[0].x + dx, y: snake[0].y + dy };

        // Check for wall or self-collision
        const hitsWall = head.x < 0 || head.x >= canvas.width / gridSize || head.y < 0 || head.y >= canvas.height / gridSize;
        const hitsSelf = snake.some(segment => segment.x === head.x && segment.y === head.y);
        if (hitsWall || hitsSelf) {
            // If a collision occurs, restart the game after alert
            alert(`Game over! Your score: ${score}`);
            startGame();
            return;
        }

        // Add the new head to the beginning of the snake array
        snake.unshift(head);

        // Check if the head has reached the apple
        if (head.x === apple.x && head.y === apple.y) {
            score++;
            updateScore();
            placeApple();
        } else {
            // If no apple eaten, remove the tail segment
            snake.pop();
        }

        // Clear the canvas
        ctx.clearRect(0, 0, canvas.width, canvas.height);

        // Draw the apple
        ctx.fillStyle = 'red';
        ctx.fillRect(apple.x * gridSize, apple.y * gridSize, gridSize, gridSize);

        // Draw the snake segments
        ctx.fillStyle = 'green';
        for (const segment of snake) {
            ctx.fillRect(segment.x * gridSize, segment.y * gridSize, gridSize, gridSize);
        }
    }

    // Listen to keyboard events to change direction
    document.addEventListener('keydown', event => {
        switch (event.key) {
            case 'ArrowUp':
                if (dy === 0) { dx = 0; dy = -1; }
                break;
            case 'ArrowDown':
                if (dy === 0) { dx = 0; dy = 1; }
                break;
            case 'ArrowLeft':
                if (dx === 0) { dx = -1; dy = 0; }
                break;
            case 'ArrowRight':
                if (dx === 0) { dx = 1; dy = 0; }
                break;
        }
    });

    // Start the game and begin the draw loop
    startGame();
    setInterval(draw, 100);
    </script>
</body>
</html>
